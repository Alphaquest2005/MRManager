// <autogenerated>
//   This file was generated by T4 code generator Amoeba-Master.tt.
//   Any changes made to this file manually will be lost next time the file is regenerated.
// </autogenerated>


using System;
using CommonMessages;
using Core.Common.UI;
using EventAggregator;
using EventMessages;
using Interfaces;
using ViewMessages;

namespace ViewModels
{
	public partial class MainViewModel 
	{
		 private static readonly MainViewModel instance;
		 static MainViewModel()
		{
			instance = new MainViewModel();
		}

		 public static MainViewModel Instance
		{
			get { return instance; }
		}

		public static SliderPanel Slider { get; set; }
		MessageSource msgSource => new MessageSource(this.ToString());

		public MainViewModel()
		{
			try
			{
				
				var a = new GetEntityById<IApplicationSetting>(msgSource);
				a.Create(1);
				EventMessageBus.Current.Publish(a,msgSource);
				EventMessageBus.Current.GetEvent<IApplicationSetting>(msgSource).Subscribe(handleApplicationSetting);
				EventMessageBus.Current.GetEvent<ViewNav>(msgSource).Subscribe(x => Slider.BringIntoView(x.View));

			}
			catch (Exception)
			{
				throw;
			}
		}

		private void handleApplicationSetting(IApplicationSetting applicationSetting)
		{
			BaseViewModel.CurrentApplicationSetting = applicationSetting;
		}
	}
}
